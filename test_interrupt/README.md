Working version of two different implementations. 
Unit tested on one motor. 
The code is very efficient and the ISR is very clean and short. 
For the details of implementation, refer to C2 report. 

Both versions will work, while 2-interrupt is more robust to errors, and 1-interrupt is faster. 
Both of them use XOR trick. 